### Reproduction of a duplicate FK bug for MySQL Connector

#### Background

There was a known problem when MySQL Connector JDBC Driver returned duplicated information about the foreign keys.
[This issue](https://bugs.mysql.com/bug.php?id=95280) has been closed as fixed in [the version 8.0.26](https://dev.mysql.com/doc/relnotes/connector-j/8.0/en/news-8-0-26.html).
I was still able to reproduce this issue with MySQL 8.0.26. This repository contains the sample data and test to reproduce the problem.

#### Steps to reproduce

1. Spin up MySQL Instance on local machine using Docker
```
$ docker run --name some-mysql -e MYSQL_ROOT_PASSWORD='Mysql123!' -p 3306:3306 -d mysql:8.0.23
```

2. Connect to the running database

```
$ docker exec -it some-mysql mysql -uroot -pMysql123!
```

3. Create the necessary database and tables
```mysql
CREATE DATABASE IF NOT EXISTS dbdemo;

USE dbdemo;

CREATE TABLE IF NOT EXISTS `AO_9412A1_AOUSER` (
`CREATED` datetime DEFAULT NULL,
`ID` bigint NOT NULL AUTO_INCREMENT,
`LAST_READ_NOTIFICATION_ID` bigint DEFAULT '0',
`TASK_ORDERING` longtext COLLATE utf8mb4_bin,
`UPDATED` datetime DEFAULT NULL,
`USERNAME` varchar(255) COLLATE utf8mb4_bin NOT NULL,
PRIMARY KEY (`ID`),
UNIQUE KEY `U_AO_9412A1_AOUSER_USERNAME` (`USERNAME`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;

CREATE TABLE IF NOT EXISTS `AO_9412A1_USER_APP_LINK` (
`APPLICATION_LINK_ID` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,
`AUTH_VERIFIED` tinyint(1) DEFAULT NULL,
`CREATED` datetime DEFAULT NULL,
`ID` bigint NOT NULL AUTO_INCREMENT,
`UPDATED` datetime DEFAULT NULL,
`USER_ID` bigint DEFAULT NULL,
PRIMARY KEY (`ID`),
KEY `fk_ao_9412a1_user_app_link_user_id` (`USER_ID`),
KEY `index_ao_9412a1_use643533071` (`APPLICATION_LINK_ID`),
CONSTRAINT `fk_ao_9412a1_user_app_link_user_id` FOREIGN KEY (`USER_ID`) REFERENCES `AO_9412A1_AOUSER` (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;
```

4. Run the unit tests
```
$ mvn test
```

#### More info

The following code works for Connector version 8.0.25, but fails for 8.0.26. Something has been regressed.
```
$ mvn test -Dmysql.connector.version=8.0.25 # PASS
$ mvn test -Dmysql.connector.version=8.0.26 # FAIL
```

The following query is generated by the Driver. The duplicated row is originated from the left join on `INFORMATION_SCHEMA.TABLE_CONSTRAINTS`. 

```mysql
SELECT DISTINCT A.REFERENCED_TABLE_SCHEMA AS PKTABLE_CAT,
                NULL                      AS PKTABLE_SCHEM,
                A.REFERENCED_TABLE_NAME   AS PKTABLE_NAME,
                A.REFERENCED_COLUMN_NAME  AS PKCOLUMN_NAME,
                A.TABLE_SCHEMA            AS FKTABLE_CAT,
                NULL                      AS FKTABLE_SCHEM,
                A.TABLE_NAME              AS FKTABLE_NAME,
                A.COLUMN_NAME             AS FKCOLUMN_NAME,
                A.ORDINAL_POSITION        AS KEY_SEQ,
                CASE
                    WHEN R.UPDATE_RULE = 'CASCADE' THEN 0
                    WHEN R.UPDATE_RULE = 'SET NULL' THEN 2
                    WHEN R.UPDATE_RULE = 'SET DEFAULT' THEN 4
                    WHEN R.UPDATE_RULE = 'RESTRICT' THEN 1
                    WHEN R.UPDATE_RULE = 'NO ACTION' THEN 1
                    ELSE 1 END            AS UPDATE_RULE,
                CASE
                    WHEN R.DELETE_RULE = 'CASCADE' THEN 0
                    WHEN R.DELETE_RULE = 'SET NULL' THEN 2
                    WHEN R.DELETE_RULE = 'SET DEFAULT' THEN 4
                    WHEN R.DELETE_RULE = 'RESTRICT' THEN 1
                    WHEN R.DELETE_RULE = 'NO ACTION' THEN 1
                    ELSE 1 END            AS DELETE_RULE,
                A.CONSTRAINT_NAME         AS FK_NAME,
                TC.CONSTRAINT_NAME        AS PK_NAME,
                7                         AS DEFERRABILITY
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE A
         JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS B USING (CONSTRAINT_NAME, TABLE_NAME)
         JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS R
              ON (R.CONSTRAINT_NAME = B.CONSTRAINT_NAME AND R.TABLE_NAME = B.TABLE_NAME AND
                  R.CONSTRAINT_SCHEMA = B.TABLE_SCHEMA)
         LEFT JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS TC
                   ON (A.REFERENCED_TABLE_SCHEMA = TC.TABLE_SCHEMA AND A.REFERENCED_TABLE_NAME = TC.TABLE_NAME AND
                       TC.CONSTRAINT_TYPE IN ('UNIQUE', 'PRIMARY KEY'))
WHERE B.CONSTRAINT_TYPE = 'FOREIGN KEY'
  AND A.TABLE_SCHEMA = 'dbdemo'
  AND A.TABLE_NAME = 'AO_9412A1_USER_APP_LINK'
  AND A.REFERENCED_TABLE_SCHEMA IS NOT NULL
ORDER BY A.REFERENCED_TABLE_SCHEMA, A.REFERENCED_TABLE_NAME, A.ORDINAL_POSITION;


+-------------+---------------+------------------+---------------+-------------+---------------+-------------------------+---------------+---------+-------------+-------------+------------------------------------+-----------------------------+---------------+
| PKTABLE_CAT | PKTABLE_SCHEM | PKTABLE_NAME     | PKCOLUMN_NAME | FKTABLE_CAT | FKTABLE_SCHEM | FKTABLE_NAME            | FKCOLUMN_NAME | KEY_SEQ | UPDATE_RULE | DELETE_RULE | FK_NAME                            | PK_NAME                     | DEFERRABILITY |
+-------------+---------------+------------------+---------------+-------------+---------------+-------------------------+---------------+---------+-------------+-------------+------------------------------------+-----------------------------+---------------+
| dbdemo      |          NULL | AO_9412A1_AOUSER | ID            | dbdemo      |          NULL | AO_9412A1_USER_APP_LINK | USER_ID       |       1 |           1 |           1 | fk_ao_9412a1_user_app_link_user_id | PRIMARY                     |             7 |
| dbdemo      |          NULL | AO_9412A1_AOUSER | ID            | dbdemo      |          NULL | AO_9412A1_USER_APP_LINK | USER_ID       |       1 |           1 |           1 | fk_ao_9412a1_user_app_link_user_id | U_AO_9412A1_AOUSER_USERNAME |             7 |
+-------------+---------------+------------------+---------------+-------------+---------------+-------------------------+---------------+---------+-------------+-------------+------------------------------------+-----------------------------+---------------+
2 rows in set (0.01 sec)
```

This is the contents of the `TABLE_CONSTRAINTS` table which explains 2 rows in it after the left join

```mysql
mysql> select * from information_schema.table_constraints where table_schema = 'dbdemo';
+--------------------+-------------------+------------------------------------+--------------+-------------------------+-----------------+----------+
| CONSTRAINT_CATALOG | CONSTRAINT_SCHEMA | CONSTRAINT_NAME                    | TABLE_SCHEMA | TABLE_NAME              | CONSTRAINT_TYPE | ENFORCED |
+--------------------+-------------------+------------------------------------+--------------+-------------------------+-----------------+----------+
| def                | dbdemo            | PRIMARY                            | dbdemo       | AO_9412A1_AOUSER        | PRIMARY KEY     | YES      |
| def                | dbdemo            | U_AO_9412A1_AOUSER_USERNAME        | dbdemo       | AO_9412A1_AOUSER        | UNIQUE          | YES      |
| def                | dbdemo            | PRIMARY                            | dbdemo       | AO_9412A1_USER_APP_LINK | PRIMARY KEY     | YES      |
| def                | dbdemo            | fk_ao_9412a1_user_app_link_user_id | dbdemo       | AO_9412A1_USER_APP_LINK | FOREIGN KEY     | YES      |
+--------------------+-------------------+------------------------------------+--------------+-------------------------+-----------------+----------+
4 rows in set (0.00 sec)
```